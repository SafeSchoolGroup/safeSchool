{% extends '::home_layout.html.twig' %}

{% block stylesheets_home %}
    <link rel="stylesheet" type="text/css" href="{{ asset('assets/css/style_exploit.css') }} " />
    <link rel="stylesheet" type="text/css" href="{{ asset('assets/fa/css/font-awesome.css') }} " />
    <link rel="stylesheet" type="text/css" href="{{ asset('assets/css/ninja-slider.css') }} " />
{% endblock %}

{% block homeBody %}
<h2 id="h2-exploit">Exploits</h2>
{% set isBoolPhotoC = 0 %}
{% for exploit in exploitsPagination %}

<div class="row" id="separat">
    <div class="row" >
        <div class="col-sm-5" id="div_row_separat">
            {% for exploitFichier in exploit.exploitFichiers %}
                {% if exploitFichier.isPhotoCouvertureExploit %}
                    {% set isBoolPhotoC = 1 %}

                        <img src="{{ asset('uploads/dossiers-exploit/' ~ exploitFichier.chemin ) | apply_filter('my_thumb') }}" id="img-exploit_image" class="img-responsive" />

                    {% else %}
                        {% set isBoolPhotoC = 0 %}
                {% endif %}

            {% endfor %}

            {% if isBoolPhotoC == 0 %}
                <img src="{{  asset('assets/img/image15.JPG')  | apply_filter('my_thumb')}}" id="img-exploit_image" class="img-responsive" />
            {% endif %}

        </div>

        <div class="col-sm-7" id="info">
            <div class="row">
                <h3>{{exploit.titre}} </h3>

                <ul class="exploit-infos" >
                    <li>Ode Sidoine</li>
                    <li>16 mars 2017</li>
                </ul>
                <p class="p-exploit" id="{{exploit.id}}pexploit">
                    {{exploit.description}}
                </p>
                <em>
                    <a href="#" id="a-plus" class="{{exploit.id}}"> Plus  <span class="caret"></span></a>
                    <a href="#" id="{{exploit.id}}" class="a-moins"> Moins <span class="fa-caret-down"></span></a>
                </em>

            </div>

            <div class="row">
                <div class="col-md-2">
                    <button type="button" id="" class="btn btn-primary" data-toggle="collapse" data-target="#{{exploit.id}}collapse" aria-expanded="false"> commenter
                    <span class="chevron right"></span>
                    </button>
                </div>

                <div class="col-md-10">
                    <div class="row">
                        <div class="col-md-2 ">
                            <a href="#" id="{{exploit.id}}point" class="btn btn-default exploit_points">Points <span>{{exploit.point}}</span></a>
                        </div>

                        <div class="col-md-2">
                            <div class="row comment">
                                <span class="glyphicon glyphicon-comment icone "></span><h6 id="vote2">500000</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div  class="row collapse" id="{{exploit.id}}collapse">


        <div class="row div-fichiers">
            {% for exploitFichier in exploit.exploitFichiers %}
                {% if exploitFichier.isPhotoCouvertureExploit == false %}
              <ul class="div-fichiers-item">
                <li>
                  <a href="#">
                    <img src="{{  asset('uploads/dossiers-exploit/' ~ exploitFichier.chemin) }}" id="" class="img-responsive" width="150" height="150"/>
                  </a>
                </li>
              </ul>
              {% endif %}
            {% endfor %}

        </div>
        <em>
             <span id="legende_dossier_exploit"> les images et dossiers liés à l'exploit ci-dessu </span>
        </em>

    </div>

</div>

{% endfor %}

<div class="navigation">
    {{ knp_pagination_render(exploitsPagination) }}
</div>




<!--    <div id="ninja-slider">
        <div class="slider-inner">
            <ul>
                <li>
                    <a class="ns-img" href=""></a>
                </li>
            </ul>
            <div id="fsBtn" class="fs-icon" title="Agrandir/Fermer"></div>
        </div>
    </div>
</div>-->
{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="{{ asset('assets/js/ninja-slider.js') }}"></script>
<script type="text/javascript" language="JavaScript"></script>
<script type="text/javascript" src="{{ asset('assets/js/exploit.js') }}"></script>

<script type="text/javascript" language="JavaScript">

    $(document).ready(function() {
        var img_href;
        var img_loader = $("div#ninja-slider .slider-inner a.ns-img");
        $("#div_row_separat img").on('click',function(e){
            img_src = $(this).attr("src");
            img_loader.attr("href",img_src);
            lightbox(0);

        })
    })


    function lightbox(idx) {
        //Show the slider wrapper
        var ninjaSldr = document.getElementById("ninja-slider");
        ninjaSldr.parentNode.style.display = "block";

        //Then init the slider
        //Note: The { initSliderByCallingInitFunc: true } option in the
        // ninja-slider.js tells the page not to initiate the slider
        // unless the following init(idx) function is called.
        //nslider.init(idx);

        //Then mimic clicking the fullscreen button to popup the modal
        var fsBtn = document.getElementById("fsBtn");
        fsBtn.click();
    }

    function fsIconClick(isFullscreen) {
        //Note: fsIconClick is the default event handler of the fullscreen button
        if (isFullscreen) {
            var ninjaSldr = document.getElementById("ninja-slider");
            ninjaSldr.parentNode.style.display = "none";
        }
    }
    </script>

    <script type="text/javascript" language="JavaScript">
    $(document).ready(function() {
      $('.col-md-2 .btn.btn-primary').click(function () {
          var element= $(this).find("span");

          if(element.hasClass("right")){
               element.removeClass("right").addClass("bottom");
          }
          else {
              element.removeClass("bottom").addClass("right");
          }

      });
  });

  // readmore js


  $(document).ready(function() {
      var div_info = $('div#info');

      div_info.on('click', function(e){
          e.preventDefault();
          var selected_elmt = e.target;
          var selected_class = $(selected_elmt).attr('class');
          var selected_id = $(selected_elmt).attr('id');


          if (selected_id == "a-plus") {
              $("p#"+selected_class+"pexploit").css('height', 'auto');
              $("#a-plus."+selected_class).css('visibility', 'hidden');
              $(".a-moins#"+selected_class).css('visibility', 'visible');
          }

          if (selected_class == "a-moins") {
              $("p#"+selected_id+"pexploit").css('height', '25px');
              $("p#"+selected_id+"pexploit").css('overflow', 'hidden');
              $("#a-plus."+selected_id).css('visibility', 'visible');
              $(".a-moins#"+selected_id).css('visibility', 'hidden');
          }

      });


  });

    </script>




{% endblock %}
